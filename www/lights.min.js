function n(){return"http://"+this.i+"/api/"+this.m+"/lights/"+this.j}function p(){return this.g()+"/state"}function q(g){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===this.readyState&&200===this.status&&JSON.parse(this.responseText)};a.open("PUT",p(),!0);a.send("string"===typeof g?g:JSON.stringify(g))}function r(g){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.responseText);"function"===typeof g&&g(a.state)}};a.open("GET",n());a.send()}function t(g,a){var k,b,f,c,d,h,e;c=6*g|0;d=6*g-c;h=1*(1-a);e=1*(1-d*a);d=1*(1-(1-d)*a);switch(c%6){case 0:k=1;b=d;f=h;break;case 1:k=e;b=1;f=h;break;case 2:k=h;b=1;f=d;break;case 3:k=h;b=e;f=1;break;case 4:k=d;b=h;f=1;break;case 5:k=1,b=h,f=e}return{r:255*k|0,b:255*b|0,a:255*f|0}}function u(){r(function(g){q({c:!g.c})})}function v(g){var a=g;"string"===typeof a&&(a=parseInt(a.replace(/^#/,""),16));var k;g=((a&16711680)>>16)/255;k=((a&65280)>>8)/255;var a=((a&255)>>0)/255,b,f,c,d,h,e=Math.max(g,k,a);c=e-Math.min(g,k,a);0===c?d=h=0:(h=c/e,b=(e-g)/6/c+.5,f=(e-k)/6/c+.5,c=(e-a)/6/c+.5,g===e?d=c-f:k===e?d=1/3+b-c:a===e&&(d=2/3+f-b),0>d?d+=1:1<d&&--d);q({h:65535*d|0,l:255*h|0,f:255*e|0})}document.addEventListener("DOMContentLoaded",function(){function g(){var a=4*(400*l.y+l.x),b=(c.data[a]<<16)+(c.data[a+1]<<8)+c.data[a+2];0!==c.data[a+3]&&(v(b),document.body.style.backgroundColor="#"+b.toString(16))}var a=document.getElementById("toggle"),k=document.getElementById("colour"),b=document.getElementById("colour-wheel"),f,c,d,h,e,l={},m;a&&a.addEventListener("click",u);k&&k.addEventListener("change",function(){v(k.value)});if(b){f=document.createElement("canvas");f.width=400;f.height=400;b.appendChild(f);a=f.getContext("2d");c=a.getImageData(0,0,400,400);for(b=0;b<c.data.length;b+=4)d=b/4%400|0,h=b/4/400|0,e=Math.sqrt(Math.pow(d-200,2)+Math.pow(h-200,2)),200<=e?(c.data[b]=0,c.data[b+1]=0,c.data[b+2]=0,c.data[b+3]=0):(200===d&&200===h?(c.data[b]=255,c.data[b+1]=255,c.data[b+2]=255):(h=Math.atan((h-200)/(d-200)),200>d&&(h+=Math.PI),d=h/(2*Math.PI),0>d&&(d+=1),e/=200,e=t(d,e),c.data[b]=e.r,c.data[b+1]=e.b,c.data[b+2]=e.a),c.data[b+3]=255);a.putImageData(c,0,0);f.addEventListener("mousemove",function(a){var b=f.getBoundingClientRect();l.x=a.clientX-b.left;l.y=a.clientY-b.top});f.addEventListener("mousedown",function(){g();m=setInterval(g,100)});f.addEventListener("mouseup",function(){clearInterval(m)});f.addEventListener("mouseout",function(){clearInterval(m)})}});
